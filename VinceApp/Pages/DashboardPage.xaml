<Page x:Class="VinceApp.Pages.DashboardPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      Title="DashboardPage" FlowDirection="RightToLeft" Background="White">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Margin="0,0,0,20">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="📊 الإحصائيات العامة" FontSize="24" FontWeight="Bold" Foreground="#333" VerticalAlignment="Center"/>
                <TextBlock Text="ملخص أداء المتجر المالي" FontSize="14" Foreground="Gray" VerticalAlignment="Center" Margin="10,5,0,0"/>
            </StackPanel>

            <Button Content="تحديث البيانات 🔄" HorizontalAlignment="Right" Padding="15,5" 
        Foreground="White" BorderThickness="0" Click="Refresh_Click">
                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="#2196F3" CornerRadius="5">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>

                        <ControlTemplate.Triggers>

                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#42A5F5"/>
                                <Setter Property="Cursor" Value="Hand"/>
                            </Trigger>

                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#0D47A1"/>
                            </Trigger>

                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Button.Template>
            </Button>
        </Grid>

        <UniformGrid Grid.Row="1" Rows="1" Columns="4" Margin="0,0,0,30">
            <Border Background="#4CAF50" CornerRadius="10" Margin="5" Padding="20" >
                <StackPanel>
                    <TextBlock Text="مبيعات اليوم" Foreground="White" Opacity="0.8" FontSize="14"/>
                    <TextBlock x:Name="txtDailySales" Text="0 د.ع" Foreground="White" FontSize="22" FontWeight="Bold" Margin="0,5,0,0"/>
                </StackPanel>
            </Border>

            <Border Background="#00BCD4" CornerRadius="10" Margin="5" Padding="20">
                <StackPanel>
                    <TextBlock Text="مبيعات آخر 7 أيام" Foreground="White" Opacity="0.8" FontSize="14"/>
                    <TextBlock x:Name="txtWeeklySales" Text="0 د.ع" Foreground="White" FontSize="22" FontWeight="Bold" Margin="0,5,0,0"/>
                </StackPanel>
            </Border>

            <Border Background="#673AB7" CornerRadius="10" Margin="5" Padding="20">
                <StackPanel>
                    <TextBlock Text="الشهر الحالي" Foreground="White" Opacity="0.8" FontSize="14"/>
                    <TextBlock x:Name="txtMonthlySales" Text="0 د.ع" Foreground="White" FontSize="22" FontWeight="Bold" Margin="0,5,0,0"/>
                </StackPanel>
            </Border>

            <Border Background="#FF9800" CornerRadius="10" Margin="5" Padding="20">
                <StackPanel>
                    <TextBlock Text="السنة الحالية" Foreground="White" Opacity="0.8" FontSize="14"/>
                    <TextBlock x:Name="txtYearlySales" Text="0 د.ع" Foreground="White" FontSize="22" FontWeight="Bold" Margin="0,5,0,0"/>
                </StackPanel>
            </Border>
        </UniformGrid>

        <Border Grid.Row="2" Background="White" BorderBrush="#EEE" BorderThickness="1" CornerRadius="10" Padding="0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Border Background="#FAFAFA" CornerRadius="10,10,0,0" Padding="15">
                    <TextBlock Text="🔥 المواد الأكثر مبيعاً (Top 10)" FontWeight="Bold" Foreground="#555" FontSize="16"/>
                </Border>

                <DataGrid x:Name="dgBestSellers" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True" 
                          HeadersVisibility="Column" Background="White" RowHeight="40" BorderThickness="0" 
                          GridLinesVisibility="Horizontal" HorizontalGridLinesBrush="#EEE">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="اسم المادة" Binding="{Binding ProductName}" Width="*" FontWeight="SemiBold"/>
                        <DataGridTextColumn Header="العدد المباع" Binding="{Binding TotalQty}" Width="150"/>
                        <DataGridTextColumn Header="إجمالي العائدات" Binding="{Binding TotalRevenue, StringFormat={}{0:N0} د.ع}" Width="150" Foreground="#4CAF50" FontWeight="Bold"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>
    </Grid>
</Page>